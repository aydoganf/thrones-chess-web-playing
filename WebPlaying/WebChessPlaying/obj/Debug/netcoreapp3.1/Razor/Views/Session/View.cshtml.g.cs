#pragma checksum "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "4e849293d4431bb8e32f27a6afd21082fb8c8a2b"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(AspNetCore.Views_Session_View), @"mvc.1.0.view", @"/Views/Session/View.cshtml")]
namespace AspNetCore
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"4e849293d4431bb8e32f27a6afd21082fb8c8a2b", @"/Views/Session/View.cshtml")]
    public class Views_Session_View : global::Microsoft.AspNetCore.Mvc.Razor.RazorPage<dynamic>
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/lib/jquery/dist/jquery.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
            WriteLiteral("\r\n");
#nullable restore
#line 2 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
  
    string apiUrl = "https://thrones-chess-api.herokuapp.com/api/chess";
    string sessionName = ViewBag.SessionName;
    string playerNickname = ViewBag.PlayerNickname;
    ViewData["Title"] = "View";
    Layout = "~/Pages/Shared/_Layout.cshtml";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<style type=""text/css"">
    #console {
        font-size: 14px;
        overflow-y: auto;
        height: 640px;
        border: 1px solid #221d1d;
        background: #f5e4cb;
        margin-top: 46px;
    }

    #board td img:hover {
        cursor: pointer;
    }

    .selected-stone {
        border: 2px solid #000 !important;
    }

    .coordinate-x {
        font-size: 13px;
        vertical-align: top;
        height: 30px !important;
    }

    .coordinate-y {
        border-color: #fff !important;
        vertical-align: middle !important;
        font-size: 13px;
    }

    .board-cell {
        width: 103px;
        height: 80px;
        text-align: center
    }

    .player-nickname {
        font-size: 24px;
        font-weight: bold;
        margin-bottom: 10px;
        text-align: center;
    }
</style>

<h1>Chess Session</h1>
<hr />
");
            WriteLiteral("    <div class=\"row\">\r\n        <div class=\"col-md-9\">\r\n\r\n            <div class=\"player-nickname\" id=\"player0\"></div>\r\n            <table class=\"table table-bordered\" id=\"board\">\r\n\r\n");
#nullable restore
#line 63 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                 for (int y = 8; y > 0; y--)
                {
                    var bg = "#d18b47";



#line default
#line hidden
#nullable disable
            WriteLiteral("                    <tr>\r\n                        <td class=\"coordinate-y\">\r\n                            ");
#nullable restore
#line 70 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                       Write(y);

#line default
#line hidden
#nullable disable
            WriteLiteral("\r\n                        </td>\r\n");
#nullable restore
#line 72 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                         for (int x = 1; x <= 8; x++)
                        {
                            bg = (y + x) % 2 == 0 ? "#d18b47" : "#ffce9e";

#line default
#line hidden
#nullable disable
            WriteLiteral("                            <td class=\"board-cell\"");
            BeginWriteAttribute("style", " style=\"", 1817, "\"", 1840, 3);
            WriteAttributeValue("", 1825, "background:", 1825, 11, true);
#nullable restore
#line 75 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
WriteAttributeValue("", 1836, bg, 1836, 3, false);

#line default
#line hidden
#nullable disable
            WriteAttributeValue("", 1839, ";", 1839, 1, true);
            EndWriteAttribute();
            WriteLiteral(" data-x=\"");
#nullable restore
#line 75 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                                                                              Write(x);

#line default
#line hidden
#nullable disable
            WriteLiteral("\" data-y=\"");
#nullable restore
#line 75 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                                                                                          Write(y);

#line default
#line hidden
#nullable disable
            WriteLiteral("\"></td>\r\n");
#nullable restore
#line 76 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                        }

#line default
#line hidden
#nullable disable
            WriteLiteral("                    </tr>\r\n");
#nullable restore
#line 78 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"

                }

#line default
#line hidden
#nullable disable
            WriteLiteral(@"            </table>
            <table>
                <tr>
                    <td class=""coordinate-y"">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
                    <td class=""board-cell coordinate-x"">a</td>
                    <td class=""board-cell coordinate-x"">b</td>
                    <td class=""board-cell coordinate-x"">c</td>
                    <td class=""board-cell coordinate-x"">d</td>
                    <td class=""board-cell coordinate-x"">e</td>
                    <td class=""board-cell coordinate-x"">f</td>
                    <td class=""board-cell coordinate-x"">g</td>
                    <td class=""board-cell coordinate-x"">h</td>
                </tr>
            </table>
            <div class=""player-nickname"" id=""player1""></div>
        </div>
        <div id=""console"" class=""col-md-3"">

        </div>
    </div>
");
            WriteLiteral("\r\n\r\n\r\n");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "4e849293d4431bb8e32f27a6afd21082fb8c8a2b8388", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral("\r\n<script type=\"text/javascript\">\r\n\r\n    let player = \'");
#nullable restore
#line 108 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
             Write(playerNickname);

#line default
#line hidden
#nullable disable
            WriteLiteral(@"';
    let currentIndexer = 0;
    let session = {};
    let xCoordinates = ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h'];

    let selectedStone = {
        type: '',
        color: '',
        location: {
            x: 0,
            y: 0
        },
        assignFrom: function (stoneInfo) {
            this.type = stoneInfo.type;
            this.color = stoneInfo.color;
            this.location.x = stoneInfo.location.split('|')[0];
            this.location.y = stoneInfo.location.split('|')[1];
        },
        move: function (x, y) {

            let from = xCoordinates[this.location.x - 1] + '' + this.location.y;
            let to = xCoordinates[x - 1] + '' + y;
            let command = from + "" "" + to;

            console.log(command);

            $.ajax({
                url: '");
#nullable restore
#line 135 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                 Write(apiUrl);

#line default
#line hidden
#nullable disable
            WriteLiteral("\',\r\n                contentType: \'application/json;charset=utf-8\',\r\n                dataType: \'json\',\r\n                method: \'POST\',\r\n                headers: { SessionName: \'");
#nullable restore
#line 139 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                                    Write(sessionName);

#line default
#line hidden
#nullable disable
            WriteLiteral(@"' },
                processData: false,
                data: '{""command"":""' + command + '""}',
                success: function (response) {
                    session = response;

                    // remove current
                    selectedStone.removeCurrentLocation();
                    selectedStone.release();


                    drawTable();
                    stoneSelectionBindings();
                },
                error: function (xhr, textStatus, errorThrown) {
                    addToConsole('error occured');
                },
                complete: function (xhr, textStatus) {
                }
            });

        },
        removeCurrentLocation: function () {
            $('#board td[data-x=""' + this.location.x + '""][data-y=""' + this.location.y + '""] img').remove();
        },
        release: function () {
            this.type = '';
            this.color = '';
            this.location.x = 0;
            this.location.y = 0;
        }
  ");
            WriteLiteral(@"  };

    function setTurn() {

        let index = session.currentIndexer;
        index += 1;
        index = index % 2;
        session.currentIndexer = index;

        var currentPlayer = getCurrentPlayer();
        addToConsole('Sıra <strong>' + currentPlayer + '</strong> oyuncusunda!');
    }


    $(document).ready(function () {

        $.ajax({
            url: '");
#nullable restore
#line 187 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
             Write(apiUrl);

#line default
#line hidden
#nullable disable
            WriteLiteral("\',\r\n            contentType: \'application/json;charset=utf-8\',\r\n            dataType: \'json\',\r\n            method: \'GET\',\r\n            headers: { SessionName: \'");
#nullable restore
#line 191 "C:\Users\faruk\source\repos\thrones-chess-web-playing\WebPlaying\WebChessPlaying\Views\Session\View.cshtml"
                                Write(sessionName);

#line default
#line hidden
#nullable disable
            WriteLiteral(@"' },
            success: function (data) {
                console.log(data);

                session = data;

                sessionCreate();
                drawTable();
            },
            error: function (xhr, textStatus, errorThrown) {
                console.log(errorThrown);
            },
            complete: function (xhr, textStatus) {
                if (textStatus === ""success"") {

                    // stone selection
                    stoneSelectionBindings();

                    // stone mmove to target location
                    stoneMovementBindings();

                }
            }
        });

    });

    function sessionCreate() {

        $('#player0').text(session.players[0].nickname);
        $('#player1').text(session.players[1].nickname);

    }

    function getCurrentPlayer() {
        return session.players[session.currentIndexer].nickname;
    }

    function drawTable() {
        for (var i = 0; i < session.table.stones.l");
            WriteLiteral(@"ength; i++) {
            let stoneInfo = session.table.stones[i];

            let stoneName = stoneInfo.type.toLowerCase() + '-' + stoneInfo.color.toLowerCase();
            let icon = '/lib/icons/' + stoneName + '.png';
            let locationX = stoneInfo.location.split('|')[0];
            let locationY = stoneInfo.location.split('|')[1];

            $('#board td[data-x=""' + locationX + '""][data-y=""' + locationY + '""]')
                .html(""<img src='"" + icon + ""' data-type='"" + stoneInfo.type + ""' data-color='"" + stoneInfo.color + ""' data-location='"" + stoneInfo.location + ""' data-stone='"" + stoneName + ""' />"");
        }

        if (session.movementResult) {
            addToConsole(session.movementResult.message);

            if (session.movementResult.check == true) {

                addToConsole('<label style=""color:red"">Şah !</label>');
            }

            if (session.movementResult.checkmate == true) {
                addToConsole('<label style=""color:red"">Şah ma");
            WriteLiteral(@"t!</label>');
            }
        }

        var currentPlayer = getCurrentPlayer();
        addToConsole('Sıra <strong>' + currentPlayer + '</strong> oyuncusunda!');
    }

    function stoneSelectionBindings() {

        $('#board td img').each(function () {
            $(this).unbind('click');
        });

        $('#board td img').on('click', function () {
            debugger;
            let x = $(this).paapiUrlpiUrlpiUrlent().data('x');
            let y = $(this).parent().data('y');
            let type = $(this).data('type');
            let color = $(this).data('color');
            let colorIndex = color === 'Black' ? 0 : 1;
            let isMyStone = player.toLowerCase() == session.players[colorIndex].nickname.toLowerCase();

            // şuanda selectedStone null ise
            // yeni bir selection yapıyorumdur
            // ve bu kesinlikle benim taşlarımdan oapiUrlmalı
            //debugger;

            if (isMyStone) {
                // clear all select");
            WriteLiteral(@"ions
                $('.selected-stone').removeClass('selected-stone');

                // add selection to current stone
                $(this).parent().addClass('selected-stone');

                // assign selectedStone
                selectedStone.type = type;
                selectedStone.color = color;
                selectedStone.location.x = x;
                selectedStone.location.y = y;
            } else {

                if (selectedStone.type !== '') {
                    selectedStone.move(x, y);
                }

            }

        });
    }

    function stoneMovementBindings() {
        $('#board td').on('click', function () {
            let x = $(this).data('x');
            let y = $(this).data('y');

            if (selectedStone.type !== '' && !(selectedStone.location.x == x && selectedStone.location.y == y)) {
                selectedStone.move(x, y);
            }
        });
    }

    function addToConsole(message) {
        let now = new");
            WriteLiteral(" Date();\r\n        let time = now.toTimeString().split(\' \')[0];\r\n\r\n        $(\'#console\').append(\'<p>[\' + time + \']: \' + message + \'</p>\');\r\n        $(\'#console\').append(\'<hr />\');\r\n    }\r\n\r\n</script>");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<dynamic> Html { get; private set; }
    }
}
#pragma warning restore 1591
